@page "/_authstatecheck"
@page "/_authstatecheck/{RedirectUri}"

@layout EmptyLayout

@using jellyfin_blazor.Identity
@using jellyfin_blazor.Services

@inject NavigationManager Navigation
@inject HttpService Http;
@inject AuthenticationContext AuthContext

@functions {

}

@code {
	[Parameter]
	public string RedirectUri { get; set; }

	protected override async Task OnInitializedAsync()
	{

		if (await AuthContext.ReceiveIdentityFromServerAsync())
		{
			// If the user is authenticated, navigate to the home page
			if (String.IsNullOrEmpty(RedirectUri)) { Navigation.NavigateTo("/"); }
			else { Navigation.NavigateTo(RedirectUri); } 
		}
		else
		{
			// If the user is not authenticated, navigate to the login page
			Navigation.NavigateTo("/login");
		}
	}
}
